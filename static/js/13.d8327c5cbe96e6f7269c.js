(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"3X9x":function(t,e,i){"use strict";var n=i("25b4"),o={name:"previewFile",components:{buttonConfirm:n.a},data:function(){return{url_to_file_extension:"/static/files-extension/"+this.file.filename.split(".").pop()+".svg",url_to_file_extension_default:"/static/files-extension/file.svg"}},props:{file:{type:Object,required:!0},height:{type:String,default:"none"},onClick:{type:Function,default:function(){}},onDelete:{type:Function,default:function(){}},to_preview:{type:Boolean,default:!1},to_download:{type:Boolean,default:!1},to_delete:{type:Boolean,default:!1}},computed:{file_url:function(){return undefined.file_to_preview.url+"#toolbar=0"}},created:function(){this.file.mime.includes("image")?this.type="img":this.type="icon",this.extension=this.file.filename.split(".").pop()},methods:{deleteFile:function(){this.onDelete()},defaultFileIcon:function(t){return t.target.src=this.url_to_file_extension_default,!0},onClickFile:function(){this.onClick()},onDownloadFile:function(){window.open(this.file.url)}}},a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"card p-0 preview-file"},[i("div",{staticClass:"preview-file-icon",on:{click:function(e){return t.onClickFile()}}},["img"===t.type?i("img",{staticClass:"card-img-top img-preview",style:"height:"+t.height+";",attrs:{src:t.file.url}}):i("img",{staticClass:"card-img-top p-3",style:"height:"+t.height+";",attrs:{src:t.url_to_file_extension},on:{error:t.defaultFileIcon}})]),t._v(" "),i("div",{staticClass:"card-body p-1 preview-file-info"},[i("div",{staticClass:"content-action-btn"},[!0===t.to_delete?i("buttonConfirm",{attrs:{icon:!0,style_btn:"btn btn-secondary action",refModal:"dialogBoxDelete",text:"Voulez-vous supprimer ce fichier ?",action:t.deleteFile}}):t._e()],1),t._v(" "),i("div",{staticClass:"content-action-btn"},[1==t.to_download?i("button",{staticClass:"btn btn-secondary action",on:{click:function(e){return t.onDownloadFile()}}},[i("i",{staticClass:"icon ion-ios-download"})]):t._e()]),t._v(" "),i("div",{staticClass:"card-text preview-file-filename"},[t._v(t._s(t.file.filename))])])])};a._withStripped=!0;var r=i("JFUb");var s=function(t){i("ZIXe")},c=Object(r.a)(o,a,[],!1,s,null,null);c.options.__file="src/features/common/previewFile.vue";e.a=c.exports},"6nf+":function(t,e,i){(t.exports=i("I1BE")(!1)).push([t.i,"\n.preview-file {\n  cursor:pointer;\n  border: 1px solid #ced4da !important;\n}\n.img-preview {\n  -o-object-fit: cover;\n     object-fit: cover;\n}\n.preview-file-info {\n  background-color: #292929;\n}\n.content-action-btn {\n  float: left;\n}\n.action {\n  padding: 0rem 0.5rem;\n  margin-right: 5px;\n}\n.preview-file-filename {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  color: #fff;\n}\n",""])},"8D53":function(t,e,i){var n=i("DgQq");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);i("SZ7m")("44c7dd5c",n,!1,{})},DgQq:function(t,e,i){(t.exports=i("I1BE")(!1)).push([t.i,"\n.no-padding[data-v-7da95bc8] {\n  padding: 0;\n}\n.ipt-f-container[data-v-7da95bc8]{\n  width: 100%;\n  padding: 5px;\n  display: inline-block;\n  overflow: hidden;\n  min-height: 120px;\n}\n.ipt-f-box[data-v-7da95bc8] {\n  border: 1px solid #c6c6c6;\n  border-radius: 2px;\n  cursor: pointer;\n  overflow: hidden;\n  width: 100%;\n  height: auto;\n  position:relative;\n  display:inline-block;\n  margin-right: 5px;\n}\n.ipt-f-box.pdf[data-v-7da95bc8] {\n  background: #ed8686;\n}\n.ipt-f-box .pdf[data-v-7da95bc8] {\n  width: 100%;\n  font-size: 20px;\n}\n.ipt-f-img[data-v-7da95bc8] {\n  display: block;\n  width: 100%;\n  height: auto;\n}\n.ipt-f-box-empty[data-v-7da95bc8] {\n  width: 100%;\n  height: 100%;\n  cursor: pointer;\n  display:-webkit-inline-box;\n  display:-ms-inline-flexbox;\n  display:inline-flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;     /* stack flex items vertically */\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;    /* center items vertically, in this case */\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;        /* center items horizontally, in this case */\n  position: relative;\n  padding-top:100%;\n}\n.bd-solid[data-v-7da95bc8] {\n  border: 2px solid #cacaca;\n  border-radius: 2px;\n}\n.bd-dashed[data-v-7da95bc8] {\n  border: 2px dashed #cacaca;\n  border-radius: 2px;\n}\n.btn-delete[data-v-7da95bc8] {\n  position: absolute;\n  bottom:0;\n  right:0;\n  font-size: 12px;\n  border-top-left-radius: 0px;\n  border-top-right-radius: 0px;\n  border-bottom-right-radius: 2px;\n  border-bottom-left-radius: 2px;\n}\n.btn-add[data-v-7da95bc8] {\n  max-width: 100px;\n  background-color: #cacaca;\n  border-color: #cacaca;\n}\n.btn-danger[data-v-7da95bc8] {\n  background-color: #dc3545 !important;\n}\n.file-name[data-v-7da95bc8] {\n  height: 12px;\n  font-size: 10px;\n  text-overflow: ellipsis;\n  width:100%;\n}\n.ipt-f-file[data-v-7da95bc8] {\n  padding: 5px;\n  margin: auto;\n}\n.i-f-add[data-v-7da95bc8]{\n  color: #cacaca;\n}\n.icon[data-v-7da95bc8] {\n  color: white;\n  font-size: 20px;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n}\n.icon > span[data-v-7da95bc8] {\n  font-size: 20px;\n  position: absolute;\n}\n.icon-attach[data-v-7da95bc8] {\n  position:absolute;\n  top:0;\n  left:0;\n  bottom:0;\n  right:0;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n}\n.native[data-v-7da95bc8] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  padding: 0 6px;\n}\n.native .icon[data-v-7da95bc8] {\n   text-decoration: line-through !important;\n   padding: 0 6px;\n   cursor: pointer;\n   color: black;\n}\n",""])},JFiH:function(t,e,i){(t.exports=i("I1BE")(!1)).push([t.i,'\n.back-to-list[data-v-77800238] {\n  font-size: 2.5em;\n  cursor: pointer;\n  padding: 10px;\n  margin-right: 20px;\n}\n.tooltip_help[data-v-77800238] {\n  display: inline-block;\n  position: relative;\n  margin: 0 20px;\n  top: 0;\n}\n.vue-js-switch[data-v-77800238] {\n  margin: 0;\n  margin-right: 10px;\n}\n.max-w-150[data-v-77800238] {\n  max-width: 150px;\n}\n.file.form-control[data-v-77800238] {\n  border: none;\n  padding: 0;\n}\n.w_parameters_preheader[data-v-77800238] {\n  width: 100%;\n  max-width: 1400px;\n  min-width: 1200px;\n  margin: 0 auto;\n}\n.form-horizontal[data-v-77800238] {\n  padding-top: 20px;\n  width: 100%;\n  max-width: 1400px;\n  min-width: 1200px;\n  margin: 0 auto;\n}\n.error[data-v-77800238]{\n  border: 1px solid;\n  border-color:#ff0000;\n}\n.switch[data-v-77800238] {\n  position: relative;\n  display: inline-block;\n  width: 60px;\n  height: 34px;\n}\n\n/* Hide default HTML checkbox */\n.switch input[data-v-77800238] {\n  opacity: 0;\n  width: 0;\n  height: 0;\n}\n\n/* The slider */\n.slider[data-v-77800238] {\n  position: absolute;\n  cursor: pointer;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: #ccc;\n  -webkit-transition: .4s;\n  transition: .4s;\n}\n.slider[data-v-77800238]:before {\n  position: absolute;\n  content: "";\n  height: 26px;\n  width: 26px;\n  left: 4px;\n  bottom: 4px;\n  background-color: white;\n  -webkit-transition: .4s;\n  transition: .4s;\n}\ninput:checked + .slider[data-v-77800238] {\n  background-color: #2196F3;\n}\ninput:focus + .slider[data-v-77800238] {\n  -webkit-box-shadow: 0 0 1px #2196F3;\n          box-shadow: 0 0 1px #2196F3;\n}\ninput:checked + .slider[data-v-77800238]:before {\n  -webkit-transform: translateX(26px);\n  transform: translateX(26px);\n}\n\n/* Rounded sliders */\n.slider.round[data-v-77800238] {\n  border-radius: 34px;\n}\n.slider.round[data-v-77800238]:before {\n  border-radius: 50%;\n}\n.mini-link-textarea[data-v-77800238] {\n  display: inline-block;\n  top: -18px;\n  font-size: 0.8em;\n  position: relative;\n}\n\n/** Variant Design **/\n.add-variant-img[data-v-77800238] {\n  font-size: 2.6em;\n  color: rgb(40, 204, 191);\n  margin-right: 10px;\n}\n.upload-wrap[data-v-77800238] {\n  position: relative;\n}\n.upload-wrap > i[data-v-77800238] {\n  position: absolute;\n}\n@media only screen and (min-width: 768px) {\n.w_parameters_preheader > form.scrolled[data-v-77800238] {\n    position: fixed;\n    z-index: 9999;\n    color: #fff;\n    -webkit-transition: bottom 0.4s ease-in-out;\n    transition: bottom 0.4s ease-in-out;\n    top: 70px;\n    position: fixed;\n    max-width: calc(1000px - -272px);\n    width: 100%;\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-pack: end;\n        -ms-flex-pack: end;\n            justify-content: flex-end;\n}\n.w_parameters_preheader > form.scrolled .btn-default[data-v-77800238], .w_parameters_preheader > form.scrolled .btn-danger[data-v-77800238] {\n    background-color: white;\n    width: 146px;\n}\n.w_parameters_preheader > form.scrolled .btn-default[data-v-77800238]:hover {\n    background-color: #28ccbf;\n}\n}\n@media only screen and (max-width: 768px) {\n#w_form_Update[data-v-77800238] :first-child {\n    float: none;\n    margin-right: 0;\n    margin-bottom: 10px;\n    text-align: center;\n}\n#w_form_Update[data-v-77800238] :first-child :first-child :first-child {\n    width: calc(100% - 20px);\n    margin: 0 auto;\n    border-radius: 4px;\n}\n.btn-default[data-v-77800238] {\n    background: #00b3ab;\n    color: #fff;\n    display: block;\n    width: calc(100% - 20px);\n    margin: 0 auto;\n    border-radius: 4px;\n}\n.w_parameters_preheader[data-v-77800238] {\n    -webkit-box-pack: center;\n        -ms-flex-pack: center;\n            justify-content: center;\n}\n.w_parameters_preheader > form[data-v-77800238] {\n    position: sticky;\n    bottom: -50px;\n    z-index: 9999;\n    color: #fff;\n    width: 100%;\n    -webkit-transition: bottom 0.4s ease-in-out;\n    transition: bottom 0.4s ease-in-out;\n}\n.w_parameters_preheader > form.scrolled[data-v-77800238] {\n    bottom: 70px;\n}\n.w_parameters_preheader > form.scrolled .btn-default[data-v-77800238], .w_parameters_preheader > form.scrolled .btn-danger[data-v-77800238] {\n    background-color: white;\n}\n.w_parameters_preheader > form.scrolled .btn-default[data-v-77800238]:hover {\n    background-color: #28ccbf;\n}\n}\n',""])},MRtN:function(t,e,i){var n=i("JFiH");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);i("SZ7m")("4e19cefc",n,!1,{})},N7Kx:function(t,e,i){(t.exports=i("I1BE")(!1)).push([t.i,"\n.option[data-v-4c74e693] {\n  position: relative;\n}\n#searchclear[data-v-4c74e693] {\n  position: absolute;\n  right: -12px !important;\n  top: 0px;\n  color: white!important;\n  font-size: 25px;\n}\n.add-select-tag-wrap[data-v-4c74e693] {\n  top: 5px;\n  left: 5px;\n  position: absolute;\n  z-index: 9;\n  width: 100%!important;\n}\n.add-select-tag[data-v-4c74e693] {\n  margin-bottom: 1px;\n  background: rgb(40, 204, 191);\n  osition: relative;\n  display: inline-block;\n  padding: 4px 26px 4px 10px;\n  border-radius: 5px;\n  margin-right: 10px;\n  color: #fff;\n  line-height: 1;\n  /* margin-bottom: 5px; */\n  white-space: nowrap;\n  overflow: hidden;\n  max-width: 100%;\n  text-overflow: ellipsis;\n}\n.add-select-wrap[data-v-4c74e693] {\n  position: relative;\n  width: 100%!important;\n}\n.add-select-wrap.has-options > .new-tag[data-v-4c74e693] {\n  padding-top: 3em;\n  padding-bottom: 1.5em;\n}\n.add-select-wrap > .new-tag[data-v-4c74e693] {\n  padding-top: 1.5em;\n  padding-bottom: 1.5em;\n}\n",""])},XXOy:function(t,e,i){(t.exports=i("I1BE")(!1)).push([t.i,"\n.w_parameters_preheader > form.scrolled .btn-danger {\n  background: white !important;\n}\n.product-add .suggest-wrap > ul {\n  max-width: 303px;\n}\n",""])},ZIXe:function(t,e,i){var n=i("6nf+");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);i("SZ7m")("610b724d",n,!1,{})},kb5Z:function(t,e,i){var n=i("N7Kx");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);i("SZ7m")("5e4066a8",n,!1,{})},odIz:function(t,e,i){var n=i("XXOy");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);i("SZ7m")("5e83371a",n,!1,{})},pJVf:function(t,e,i){"use strict";i.r(e);var n=i("14Xm"),o=i.n(n),a=i("GQeE"),r=i.n(a),s=i("D3Ub"),c=i.n(s),l=i("rfXi"),d=i.n(l),p=i("QbLZ"),u=i.n(p),f=i("oCYn"),m=i("L2JU"),h=i("PaCj"),b=i("8l+Y"),v=(i("1LJ2"),i("Kqdw")),_=i("vOup"),g=i("25b4"),x=i("s+Lo"),k=i("sBL/"),w=i("WHOg"),y=i("Yvet"),C={name:"AddSelect",props:{value:{type:Array}},data:function(){return{newOption:""}},methods:{addNewOption:function(){this.value||(this.value=[]),this.value.push(this.newOption),this.newOption="",this.$forceUpdate()},updateValue:function(t){this.$emit("change",t)},clearOption:function(t){var e=this.value.findIndex((function(e){return e===t}));this.value.splice(e,1)}}},$=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"input-group add-select-wrap",class:{"has-options":t.value&&t.value.length>0}},[i("div",{staticClass:"add-select-tag-wrap"},t._l(t.value,(function(e){return i("div",{staticClass:"option add-select-tag"},[i("div",[t._v(t._s(e))]),t._v(" "),i("span",{attrs:{id:"searchclear"},on:{click:function(){return t.clearOption(e)}}},[i("i",{staticClass:"icon ion-ios-close"})])])})),0),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.newOption,expression:"newOption"}],staticClass:"form-control new-tag",attrs:{placeholder:"Saisir une option et appuyer sur 'entrée'"},domProps:{value:t.newOption},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addNewOption(e)},input:function(e){e.target.composing||(t.newOption=e.target.value)}}})])};$._withStripped=!0;var F=i("JFUb");var S=function(t){i("kb5Z")},N=Object(F.a)(C,$,[],!1,S,"data-v-4c74e693",null);N.options.__file="src/features/common/add-select.vue";var O,T=N.exports,V=i("reSd"),P=i.n(V),z={name:"ProductAdd",data:function(){return{errors:{},product:{image:{},files:[],options:[{name:"",values:[]},{name:"",values:[]}],is_marchandise:!1,hasVariations:!1,electronic:!1},variantFields:[{key:"title",label:"Variante"},{key:"reference",label:"Référence "},{key:"price_ttc",label:"Prix TTC"},{key:"sku",label:"SKU"},{key:"visible",label:"Disponible"}],variantFieldsStock:[{key:"title",label:"Variante"},{key:"reference",label:"Référence"},{key:"stock",label:"Quantité en stock"},{key:"min",label:"Stock minimum"},{key:"alert",label:"Seuil d'alerte"}],defaultOptionsNames:["Taille","Poids","Couleur","Matière","Contenant"],displayedOptionNames:[],product_stock:{},product_specifications:{},product_categories:[],product_stock_available:!1,product_specifications_available:!1,bus:new f.default,vatRates:[],customImageMaxSize:3,currentTab:0,customToolbar:[["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"},{list:"check"}],[{size:["small",!1,"large"]}],[{color:[]},{background:[]},"link"]]}},components:{buttonConfirm:g.a,inputFileCustom:x.a,VueEditor:w.a,"add-select":T,VueBase64FileUpload:P.a},computed:u()({},Object(m.b)({company:"getCompany"})),watch:{"product.options":{handler:function(t){this.calculateVariants()},deep:!0},"$route.path":{handler:function(t){this.init()},deep:!0}},created:function(){this.init()},methods:{init:function(){var t=this;this.mode=this.$route.params.id?"update":"create",this.currentTab=this.$route.params.tab||0,this.regexUrl=/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\(\)\*\+,;=.]+$/,this.product_add_create_lbl="update"===this.mode?this.$t("products.update"):this.$t("products.new"),this.legalExplanation='Si votre produit (service ou marchandise) nécessite qu\'une mention obligatoire apparaisse sur vos documents, renseignez la dans ce champ. Elle figurera automatiquement dès ajout du produit sur la facture ou le devis.<br /><br />  Exemple 1 : Votre produit est une prestation de service se rattachant à un immeuble -> Indiquez dans le champ : " article 47 de la directive 2006/112/CE ou article 259 A 2° du CGI"<br /><br />  Exemple 2 : Quand la livraison intracommunautaire d\'un moyen de transport neuf est exonérée de TVA, la facture doit comporter certaines informations, dont la mention "Exonération de TVA, article 298 sexies du CGI". Indiquez-celle ci dans le champ.<br /><br />En complétant le champ "Mentions obligatoires", les mentions automatiques n\'apparaitront pas lors de la facturation du produit.',this.boxesNumber=3,this.$parent.$emit("updateTabs",[]),this.$parent.$emit("updateMenu",[]),this.$store.dispatch(b.h,{company:this.company}).then((function(e){t.product_categories=e.data.product_categories})),"update"===this.mode?this.$store.dispatch(h.g,{id:this.$route.params.id}).then((function(e){t.product=e.data.product,t.product.category&&t.product.category._id&&(t.product.category=t.product.category._id),t.product.stock&&(t.product_stock_available=!0,t.product_stock=t.product.stock,t.product.hasStockManagement=!0),t.product.specifications&&(t.product_specifications_available=!0,t.product_specifications=t.product.specifications),t.product.image||(t.product.image={}),t.product.files||(t.product.files=[]),t.loadTVA()})).catch((function(){t.$router.push("/products")})):(this.product.is_marchandise=this.company.sell_marchandise||!1,this.product.is_marchandise||(this.product.electronic=this.company.sell_electronic||!1),this.loadTVA()),this.bus.$on("new_file",this.affectNewImage),this.bus.$on("new_files",this.affectNewFiles)},rowClass:function(t,e){return t&&"row"===e?!1===t.visible?"disabled":void 0:null},onLoad:function(t){t.image=dataUri},onSizeExceeded:function(t){alert("Image "+t+"Mb size exceeds limits of "+this.customImageMaxSize+"Mb!")},setOptions:function(){!0!==this.product.hasVariations||this.product.options&&0!==this.product.options.length||(this.product.options=[{name:"",values:[]},{name:"",values:[]}],this.$forceUpdate())},onSelect:function(t,e){e.name=t,this.$forceUpdate()},onInputOptionName:function(t){this.displayedOptionNames=this.defaultOptionsNames.filter((function(e){return e.toUpperCase().includes(t.toUpperCase())?e:null}))},addOption:function(){this.product.options.push({name:"",values:[]})},deleteOption:function(t){this.product.options.splice(t,1)},calculateVariants:function(){var t=this,e=this.product.variants;this.product.variants=[];var i=0;this.product.options&&this.product.options[0]&&this.product.options[0].values&&this.product.options[0].values.forEach((function(n){if(t.product.options[1]&&t.product.options[1].values&&t.product.options[1].values.length>0)t.product.options[1].values.forEach((function(o){i++;var a=e.find((function(t){return t.title===n+" / "+o}));a?(a.stock||(a.stock={}),t.product.variants.push(a)):t.product.variants.push({id:i,name:t.product.name,reference:t.product.reference,product:t.product._id,company:t.product.company,title:n+" / "+o,price_ttc:t.product.price_ttc,stock:{},visible:!0})}));else{var o=e.find((function(t){return t.title===n}));o?(o.stock||(o.stock={}),t.product.variants.push(o)):t.product.variants.push({id:i,name:t.product.name,reference:t.product.reference,product:t.product._id,company:t.product.company,title:n,price_ttc:t.product.price_ttc,stock:{},visible:!0})}})),this.$forceUpdate()},addFile:function(t,e,i){var n=new FormData;e.length&&(d()(Array(e.length).keys()).map((function(i){n.append(t,e[i],e[i].name)})),this.product_files[i-1]?this.product_files[i-1]=n:this.product_files.push(n))},affectNewImage:function(t){this.product.image=t,this.$forceUpdate()},affectNewFiles:function(t){this.product.files=t,this.$forceUpdate()},checkUrl:Object(k.debounce)((function(t){this.regexUrl.test(this.product.url_ext)}),600),editProduct:(O=c()(o.a.mark((function t(){var e,i,n=this;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.verifyForm(),e=this.$store.getters.getCompany._id,this.product.company=e,0!==r()(this.errors).length){t.next=15;break}if("update"!==this.mode){t.next=13;break}return i=[],t.next=8,Object(y.a)(this.product.variants,function(){var t=c()(o.a.mark((function t(e){var a,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=void 0,r=void 0,!e._id){t.next=8;break}return t.next=4,n.$store.dispatch(h.l,e);case 4:a=t.sent,r=a.data.updatedProductVariant,t.next=12;break;case 8:return t.next=10,n.$store.dispatch(h.j,e);case 10:a=t.sent,r=a.data.new_product_variant;case 12:i.push(r._id);case 13:case"end":return t.stop()}}),t,n)})));return function(e){return t.apply(this,arguments)}}());case 8:return this.product.variants=i,t.next=11,this.$store.dispatch(h.h,{updated_product:this.product}).then((function(t){n.displaySuccess(t.data.updatedProduct.reference,!0),n.$router.push({name:"ProductsList"})})).catch((function(){n.displayError()}));case 11:t.next=15;break;case 13:return t.next=15,this.$store.dispatch(h.e,{created_product:this.product}).then((function(t){n.displaySuccess(t.data.new_product.reference),n.$router.push({name:"ProductEdit",params:{id:t.data.new_product._id}})})).catch((function(){n.displayError()}));case 15:case"end":return t.stop()}}),t,this)}))),function(){return O.apply(this,arguments)}),displayError:function(){this.$notify({group:"alert",type:"error",title:"Echec de l'ajout du produit",text:"Votre produit n'a pas été ajouté à la liste"})},displaySuccess:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e?"mis à jour":"ajouté";this.$notify({group:"alert",type:"success",title:"Produit "+i,text:"Vous avez "+i+" un produit (Ref "+t+")"})},deleteProduct:function(){var t=this;this.product._id&&this.$store.dispatch(h.f,{deleted_product:this.product}).then((function(e){t.$notify({group:"alert",type:"success",title:"Produit supprimé",text:"Vous avez supprimé un produit"}),t.$router.push("/products")})).catch((function(){t.displayError()}))},getCurrentTVARate:function(){var t=this,e=this.vatRates.find((function(e){return e._id===t.product.tva}));return e?e.rate:0},loadTVA:function(){var t=this;this.$store.dispatch(v.E).then((function(e){if(t.vatRates=e,t.product.tva)t.onTVAChange();else{var i=t.company.defaultVatRate,n=i?t.vatRates.find((function(t){return t._id===i})):t.vatRates.find((function(t){return 0===t.rate}));t.product.tva=n._id,t.product.tva_rate=0}}))},onPriceHTChange:function(){this.product.price_ttc=Object(_.g)(this.product.price_ht,this.getCurrentTVARate()),this.$forceUpdate()},onPriceTTCChange:function(){this.product.price_ht=Object(_.d)(this.product.price_ttc,this.getCurrentTVARate()),this.$forceUpdate()},onTVAChange:function(){var t=this,e=this.vatRates.find((function(e){return e._id===t.product.tva}));e&&(this.product.tva_rate=e.rate),this.onPriceHTChange(),this.onPriceTTCChange()},onToggleServiceChange:function(t){!1===t.value&&(this.product_specifications_available=!1,this.product_specifications={},delete this.product.specifications)},verifyForm:function(){this.message=null,this.errors={},this.product.reference||this.product.name||(this.errors.reference=!this.product.reference,this.errors.name=!this.product.name),isNaN(this.product.price_ht)&&(this.errors.price_ht=!0),void 0===this.product.tva_rate&&(this.errors.tva_rate=!0),this.product.url_ext&&(this.regexUrl.test(this.product.url_ext)||(this.errors.url_ext=!0)),this.product.stock={},!0===this.product.hasStockManagement?this.product.stock=this.product_stock:this.product.stock=null,this.product.specifications={},!0===this.product_specifications_available?this.product.specifications=this.product_specifications:this.product.specifications=null}}},E=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("b-container",{staticClass:"container-xxl product-add",attrs:{fluid:""}},[i("b-form",{attrs:{method:"post"},on:{submit:function(e){return e.preventDefault(),t.editProduct(e)}}},[i("b-card",[i("div",{staticClass:"w_parameters_preheader"},[i("i",{staticClass:"icon ion-ios-arrow-round-back back-to-list",on:{click:function(e){return t.$router.go(-1)}}}),t._v(" "),i("h1",{staticClass:"title no-margin-b"},[t._v(t._s(t.product_add_create_lbl))]),t._v(" "),i("form",{attrs:{method:"post",id:"w_form_Update"},on:{submit:function(e){return e.preventDefault(),t.editProduct(e)}}},[i("div",{staticClass:"pull-left margin-r"},["update"===t.mode?i("buttonConfirm",{attrs:{button:t.$t("global.delete"),refModal:"dialogBoxDelete",text:t.$t("dialog_box.delete_product"),action:t.deleteProduct}}):t._e()],1),t._v(" "),i("button",{staticClass:"btn btn-default",attrs:{type:"submit"}},[t._v(t._s("update"===t.mode?t.$t("global.save"):t.$t("global.create")))])])]),t._v(" "),i("div",{staticClass:"form-horizontal"},[i("b-tabs",{attrs:{"content-class":"mt-3",fill:""},model:{value:t.currentTab,callback:function(e){t.currentTab=e},expression:"currentTab"}},[i("b-tab",{attrs:{title:"Général"}},[i("b-row",{staticClass:"product-form"},[i("b-col",{attrs:{cols:"12",sm:"6"}},[i("b-form-group",{attrs:{label:t.$t("products.list.reference"),"label-for":"productReference",description:t.$t("products.description.reference")}},[i("b-form-input",{class:{error:t.errors.reference},attrs:{id:"productReference",autofocus:"",type:"text",placeholder:""},model:{value:t.product.reference,callback:function(e){t.$set(t.product,"reference",e)},expression:"product.reference"}})],1),t._v(" "),i("b-form-group",{attrs:{label:t.$t("products.list.name"),"label-for":"productName"}},[i("b-form-input",{class:{error:t.errors.name},attrs:{id:"productName",type:"text",placeholder:""},model:{value:t.product.name,callback:function(e){t.$set(t.product,"name",e)},expression:"product.name"}})],1),t._v(" "),t.product_categories&&t.product_categories.length>0?i("b-form-group",{attrs:{label:t.$t("products.list.category"),"label-for":"productDescription",description:t.$t("products.description.category")}},[i("b-form-select",{model:{value:t.product.category,callback:function(e){t.$set(t.product,"category",e)},expression:"product.category"}},t._l(t.product_categories,(function(e){return i("option",{domProps:{value:e._id}},[t._v(t._s(e.name))])})),0)],1):t._e(),t._v(" "),i("b-form-group",{attrs:{label:"Code analytique",description:"Insérez ici votre compte produit"}},[i("b-form-input",{attrs:{type:"text",placeholder:"Compte produit"},model:{value:t.product.analytical_code,callback:function(e){t.$set(t.product,"analytical_code",e)},expression:"product.analytical_code"}})],1),t._v(" "),i("b-form-group",{attrs:{label:t.$t("products.url_ext")}},[i("b-form-input",{class:{error:t.errors.url_ext},attrs:{id:"productUrlExt",type:"text"},on:{input:t.checkUrl},model:{value:t.product.url_ext,callback:function(e){t.$set(t.product,"url_ext",e)},expression:"product.url_ext"}})],1)],1),t._v(" "),i("b-col",{staticClass:"justify-content-start",attrs:{cols:"12",sm:"3"}},[i("b-form-group",{attrs:{label:t.$t("products.image")}},[i("inputFileCustom",{attrs:{file:t.product.image,bus:t.bus,accept:"image/*"}})],1)],1)],1),t._v(" "),i("b-row",[i("b-col",{attrs:{cols:"12",sm:"12"}},[i("b-form-group",{attrs:{label:t.$t("products.list.description"),"label-for":"productDescription",description:t.$t("products.description.description")}},[i("vue-editor",{attrs:{editorToolbar:t.customToolbar},model:{value:t.product.description,callback:function(e){t.$set(t.product,"description",e)},expression:"product.description"}})],1)],1),t._v(" "),i("b-col",{attrs:{cols:"12",sm:"4"}},[i("b-form-group",{attrs:{label:t.$t("products.list.price_ht"),"label-for":"productPriceHT"}},[i("b-form-input",{class:{error:t.errors.price_ht},attrs:{id:"productPriceHT",type:"number",step:"0.01",placeholder:""},on:{input:t.onPriceHTChange},model:{value:t.product.price_ht,callback:function(e){t.$set(t.product,"price_ht",e)},expression:"product.price_ht"}})],1)],1),t._v(" "),i("b-col",{attrs:{cols:"12",sm:"4"}},[i("b-form-group",{attrs:{label:t.$t("products.list.tva_rate"),"label-for":"productTvaRate"}},[i("b-form-select",{on:{input:t.onTVAChange},model:{value:t.product.tva,callback:function(e){t.$set(t.product,"tva",e)},expression:"product.tva"}},t._l(t.vatRates,(function(e){return i("option",{domProps:{value:e._id}},[t._v(t._s(e.name))])})),0)],1)],1),t._v(" "),i("b-col",{attrs:{cols:"12",sm:"4"}},[i("b-form-group",{attrs:{label:t.$t("products.list.price_ttc"),"label-for":"productPriceTTC"}},[i("b-form-input",{attrs:{id:"productPriceTTC",type:"number",step:"0.01",placeholder:""},on:{input:t.onPriceTTCChange},model:{value:t.product.price_ttc,callback:function(e){t.$set(t.product,"price_ttc",e)},expression:"product.price_ttc"}})],1)],1),t._v(" "),i("b-col",{attrs:{cols:"12",sm:"4"}},[i("b-form-group",{attrs:{label:t.$t("products.list.buying_price"),"label-for":"productBuyingPrice"}},[i("b-form-input",{attrs:{id:"productBuyingPrice",type:"number",step:"0.01",placeholder:""},model:{value:t.product.buying_price,callback:function(e){t.$set(t.product,"buying_price",e)},expression:"product.buying_price"}})],1)],1),t._v(" "),i("b-col",{attrs:{cols:"12",sm:"4"}},[i("b-form-group",{attrs:{label:t.$t("products.specifications.ecotax"),"label-for":"productEcotax"}},[i("b-form-input",{attrs:{id:"productEcotax",type:"number",step:"0.01",placeholder:""},model:{value:t.product.ecotax,callback:function(e){t.$set(t.product,"ecotax",e)},expression:"product.ecotax"}})],1)],1)],1)],1),t._v(" "),"update"===t.mode?i("b-tab",{attrs:{title:"Options des déclinaisons"}},[i("div",{staticClass:"flex margin-b"},[i("toggle-button",{attrs:{id:"product_stock_available",sync:!0,color:"#28ccbf"},on:{input:t.setOptions},model:{value:t.product.hasVariations,callback:function(e){t.$set(t.product,"hasVariations",e)},expression:"product.hasVariations"}}),t._v(" Ce produit comporte plusieurs options\n              ")],1),t._v(" "),i("b-row",{directives:[{name:"show",rawName:"v-show",value:!0===t.product.hasVariations,expression:"product.hasVariations === true"}],staticClass:"margin-b"},[i("b-col",{attrs:{cols:"12"}},[i("h1",[t._v("Options")]),t._v(" "),i("div",{staticClass:"w-100 d-block italic"},[t._v("Exemple")]),t._v(" "),i("div",{staticClass:"w-100 d-block italic"},[t._v("Option 1 : 'Couleur' => 'Rouge, Bleu, Vert'")]),t._v(" "),i("div",{staticClass:"w-100 d-block italic"},[t._v("Option 2 : 'Poids' => '100g, 200g'")]),t._v(" "),t._l(t.product.options,(function(e,n){return i("div",[i("form",{staticClass:"form-inline margin-b"},[i("div",{staticClass:"w-100 d-block italic margin-t"},[t._v("Indiquez l'intitulé d'option de votre choix (poids, taille, matière, couleur, contenant, ...)")]),t._v(" "),i("div",{staticClass:"d-flex center justify-content-start"},[i("label",{staticClass:"margin-r"},[t._v("Option "+t._s(n+1))]),t._v(" "),i("vue-suggest",{attrs:{"input-classes":"form-control",options:t.displayedOptionNames,placeholder:"Nom de l'option (Tailles, poids, couleurs, etc...)"},on:{select:function(i){return t.onSelect(i,e)},input:t.onInputOptionName},model:{value:e.name,callback:function(i){t.$set(e,"name",i)},expression:"option.name"}})],1),t._v(" "),i("div",{staticClass:"margin-t italic"},[t._v('Saisissez une option puis appuyez sur la touche "entrée" (rouge, bleu, s, m, xl, ...)')]),t._v(" "),i("add-select",{model:{value:e.values,callback:function(i){t.$set(e,"values",i)},expression:"option.values"}})],1)])}))],2)],1),t._v(" "),t.product.variants&&!0===t.product.hasVariations?i("div",{staticClass:"margin-b"},[i("h1",[t._v("Aperçu des déclinaisons")]),t._v(" "),i("b-table",{attrs:{items:t.product.variants,fields:t.variantFields,"tbody-tr-class":t.rowClass},scopedSlots:t._u([{key:"img",fn:function(e){return[i("div",{staticClass:"upload-wrap"},[i("i",{staticClass:"add-variant-img ion-ios-image"}),t._v(" "),i("vue-base64-file-upload",{staticClass:"form-group params-logo",staticStyle:{"max-width":"46px"},attrs:{"default-preview":e.item.image,accept:"image/png,image/jpeg","image-class":"add-variant-img ion-ios-image","input-class":"v1-input hidden","max-size":t.customImageMaxSize},on:{"size-exceeded":t.onSizeExceeded,load:function(){return t.onLoad(e.item)}},model:{value:e.item.image,callback:function(i){t.$set(e.item,"image",i)},expression:"data.item.image"}})],1)]}},{key:"reference",fn:function(e){return[i("input",{directives:[{name:"model",rawName:"v-model",value:e.item.reference,expression:"data.item.reference"}],attrs:{type:"text"},domProps:{value:e.item.reference},on:{input:function(i){i.target.composing||t.$set(e.item,"reference",i.target.value)}}})]}},{key:"price_ttc",fn:function(e){return[i("input",{directives:[{name:"model",rawName:"v-model",value:e.item.price_ttc,expression:"data.item.price_ttc"}],staticClass:"w-60",attrs:{type:"number"},domProps:{value:e.item.price_ttc},on:{input:function(i){i.target.composing||t.$set(e.item,"price_ttc",i.target.value)}}})]}},{key:"sku",fn:function(e){return[i("input",{directives:[{name:"model",rawName:"v-model",value:e.item.sku,expression:"data.item.sku"}],attrs:{type:"text"},domProps:{value:e.item.sku},on:{input:function(i){i.target.composing||t.$set(e.item,"sku",i.target.value)}}})]}},{key:"visible",fn:function(e){return[i("toggle-button",{attrs:{color:"#00bdaf",width:33,height:18},model:{value:e.item.visible,callback:function(i){t.$set(e.item,"visible",i)},expression:"data.item.visible"}})]}}],null,!1,989174600)})],1):t._e()],1):t._e(),t._v(" "),"update"===t.mode?i("b-tab",{attrs:{title:"Gestion des stocks"}},[i("div",{staticClass:"flex margin-b"},[i("toggle-button",{attrs:{id:"product_stock_available",sync:!0,color:"#28ccbf"},model:{value:t.product.hasStockManagement,callback:function(e){t.$set(t.product,"hasStockManagement",e)},expression:"product.hasStockManagement"}}),t._v(" "+t._s(t.$t("products.stock.available")))],1),t._v(" "),i("b-row",{directives:[{name:"show",rawName:"v-show",value:t.product.hasStockManagement&&!t.product.hasVariations,expression:"product.hasStockManagement && !product.hasVariations"}]},[i("b-col",{attrs:{cols:"12",sm:"4"}},[i("b-form-group",{attrs:{label:t.$t("products.stock.nb"),"label-for":"productNbStock"}},[i("b-form-input",{class:{error:t.errors.stock_nb},attrs:{id:"productNbStock",type:"number",step:"0.01"},model:{value:t.product_stock.nb_stock,callback:function(e){t.$set(t.product_stock,"nb_stock",e)},expression:"product_stock.nb_stock"}})],1)],1),t._v(" "),i("b-col",{attrs:{cols:"12",sm:"4"}},[i("b-form-group",{attrs:{label:t.$t("products.stock.nb_min"),"label-for":"productNbStockMin"}},[i("b-form-input",{class:{error:t.errors.stock_nb_min},attrs:{id:"productNbStockMin",type:"number",step:"0.01"},model:{value:t.product_stock.nb_min,callback:function(e){t.$set(t.product_stock,"nb_min",e)},expression:"product_stock.nb_min"}})],1)],1),t._v(" "),i("b-col",{attrs:{cols:"12",sm:"4"}},[i("b-form-group",{attrs:{label:t.$t("products.stock.nb_alert"),"label-for":"productNbStockAlert"}},[i("b-form-input",{attrs:{id:"productNbStockAlert",type:"number",step:"0.01"},model:{value:t.product_stock.nb_alert,callback:function(e){t.$set(t.product_stock,"nb_alert",e)},expression:"product_stock.nb_alert"}})],1)],1)],1),t._v(" "),t.product.variants?i("b-row",{directives:[{name:"show",rawName:"v-show",value:t.product.hasStockManagement&&t.product.hasVariations,expression:"product.hasStockManagement && product.hasVariations"}]},[i("b-table",{attrs:{items:t.product.variants.filter((function(t){return t.visible})),fields:t.variantFieldsStock},scopedSlots:t._u([{key:"stock",fn:function(e){return[i("input",{directives:[{name:"model",rawName:"v-model",value:e.item.stock.nb_stock,expression:"data.item.stock.nb_stock"}],staticClass:"w-60",attrs:{type:"number"},domProps:{value:e.item.stock.nb_stock},on:{input:function(i){i.target.composing||t.$set(e.item.stock,"nb_stock",i.target.value)}}})]}},{key:"min",fn:function(e){return[i("input",{directives:[{name:"model",rawName:"v-model",value:e.item.stock.nb_min,expression:"data.item.stock.nb_min"}],staticClass:"w-60",attrs:{type:"number"},domProps:{value:e.item.stock.nb_min},on:{input:function(i){i.target.composing||t.$set(e.item.stock,"nb_min",i.target.value)}}})]}},{key:"alert",fn:function(e){return[i("input",{directives:[{name:"model",rawName:"v-model",value:e.item.stock.nb_alert,expression:"data.item.stock.nb_alert"}],staticClass:"w-60",attrs:{type:"number"},domProps:{value:e.item.stock.nb_alert},on:{input:function(i){i.target.composing||t.$set(e.item.stock,"nb_alert",i.target.value)}}})]}}],null,!1,3995533532)})],1):t._e()],1):t._e(),t._v(" "),"update"===t.mode?i("b-tab",{attrs:{title:"Complémentaires"}},[i("div",{staticClass:"flex margin-b"},[i("toggle-button",{attrs:{sync:!0,color:{checked:"#f19751",unchecked:"#28ccbf"},width:100,labels:{checked:"Marchandise",unchecked:"Service"}},on:{change:t.onToggleServiceChange},model:{value:t.product.is_marchandise,callback:function(e){t.$set(t.product,"is_marchandise",e)},expression:"product.is_marchandise"}}),t._v(" "),t.product.is_marchandise?i("toggle-button",{attrs:{sync:!0,color:{checked:"#f19751",unchecked:"#28ccbf"},width:100,labels:{checked:"Physique",unchecked:"Dématérialisé"}},model:{value:t.product_specifications_available,callback:function(e){t.product_specifications_available=e},expression:"product_specifications_available"}}):t._e(),t._v(" "),t.product.is_marchandise?t._e():i("toggle-button",{attrs:{sync:!0,color:{checked:"#f19751",unchecked:"#28ccbf"},width:100,labels:{checked:"Electronique",unchecked:"Cas général"}},on:{change:t.onToggleServiceChange},model:{value:t.product.electronic,callback:function(e){t.$set(t.product,"electronic",e)},expression:"product.electronic"}})],1),t._v(" "),i("b-row",[i("b-col",{staticClass:"form-group",attrs:{cols:"12",sm:"12"}},[i("label",[i("div",{staticStyle:{display:"inline-block"}},[t._v("\n              Mentions obligatoires\n              "),i("a",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.legalExplanation,expression:"legalExplanation"}],staticClass:"tooltip_help badge",attrs:{tabindex:"-1",href:"javascript:void(0);"}},[t._v("?")])])]),t._v(" "),i("b-form-group",{attrs:{description:"Wuro applique des mentions obligatoires automatiquement sur les documents (devis, factures...). Nous vous invitons à consulter cette page pour savoir lesquelles :"}},[i("vue-editor",{attrs:{editorToolbar:t.customToolbar},model:{value:t.product.mandatory_mentions,callback:function(e){t.$set(t.product,"mandatory_mentions",e)},expression:"product.mandatory_mentions"}})],1),t._v(" "),i("a",{staticClass:"mini-link-textarea",attrs:{href:"https://www.wuro.fr/pages/aide/factures/facturation-mentions-obligatoires.html"}},[t._v("Facturation : Mentions obligatoires.")])],1)],1),t._v(" "),i("b-row",{directives:[{name:"show",rawName:"v-show",value:t.product_specifications_available&&t.product.is_marchandise,expression:"product_specifications_available && product.is_marchandise"}]},[i("b-col",{attrs:{cols:"12",sm:"4"}},[i("b-form-group",{attrs:{label:t.$t("products.specifications.width"),"label-for":"productWidth"}},[i("b-form-input",{attrs:{id:"productWidth",type:"number",step:"0.01"},model:{value:t.product_specifications.width,callback:function(e){t.$set(t.product_specifications,"width",e)},expression:"product_specifications.width"}})],1)],1),t._v(" "),i("b-col",{attrs:{cols:"12",sm:"4"}},[i("b-form-group",{attrs:{label:t.$t("products.specifications.height"),"label-for":"productHeight"}},[i("b-form-input",{attrs:{id:"productHeight",type:"number",step:"0.01"},model:{value:t.product_specifications.height,callback:function(e){t.$set(t.product_specifications,"height",e)},expression:"product_specifications.height"}})],1)],1),t._v(" "),i("b-col",{attrs:{cols:"12",sm:"4"}},[i("b-form-group",{attrs:{label:t.$t("products.specifications.depth"),"label-for":"productDepth"}},[i("b-form-input",{attrs:{id:"productDepth",type:"number",step:"0.01"},model:{value:t.product_specifications.depth,callback:function(e){t.$set(t.product_specifications,"depth",e)},expression:"product_specifications.depth"}})],1)],1),t._v(" "),i("b-col",{attrs:{cols:"12",sm:"4"}},[i("b-form-group",{attrs:{label:t.$t("products.specifications.weight"),"label-for":"productWeight"}},[i("b-form-input",{attrs:{id:"productWeight",type:"number",step:"0.01"},model:{value:t.product_specifications.weight,callback:function(e){t.$set(t.product_specifications,"weight",e)},expression:"product_specifications.weight"}})],1)],1)],1)],1):t._e(),t._v(" "),"update"===t.mode?i("b-tab",{attrs:{title:"Fichiers joints"}},[i("b-row",[i("b-col",{attrs:{cols:"12",sm:"12"}},[i("b-form-group",{attrs:{label:t.$t("products.files")}},[i("inputFileCustom",{attrs:{files:t.product.files,bus:t.bus,type:"depot",busName:"new_files",height:"130px",width:"90px"}})],1)],1)],1)],1):t._e()],1)],1)])],1)],1)};E._withStripped=!0;var j=function(t){i("odIz"),i("MRtN")},D=Object(F.a)(z,E,[],!1,j,"data-v-77800238",null);D.options.__file="src/features/products/ProductAdd.vue";e.default=D.exports},"s+Lo":function(t,e,i){"use strict";var n=i("rfXi"),o=i.n(n),a=i("QbLZ"),r=i.n(a),s=i("L2JU"),c=i("1LJ2"),l=(i("//bJ"),{components:{previewFile:i("3X9x").a},data:function(){return{idx:-1,new_file:this.file,new_files:this.files,file_loading:!1,files_loading:[],loading:!1}},props:{native:{type:Boolean,default:!1},type:{type:String,default:"single"},limit:{type:Number,default:1},files:{type:Array},file:{type:Object},data:{type:String,default:"emstorage"},bus:{type:Object,required:!0},busName:{type:String,default:"new_file"},width:{type:String,default:"none"},height:{type:String,default:"none"},accept:{type:String,default:""}},computed:r()({},Object(s.b)({company:"getCompany"}),{myBoxDimensions:function(){return{height:this.height,width:this.width}},myContenerDimensions:function(){return{}}}),created:function(){if(this.files)for(var t=0;t<this.limit;t++)this.files_loading[t]=!1},methods:{searchFile:function(t){this.idx=t,this.$refs.inputFile.click()},addFile:function(t,e){var i=this;this.loading=!0;var n=new FormData;if(e.length){o()(Array(e.length).keys()).map((function(i){n.append(t,e[i],e[i].name)}));var a=this.company;"alone"===this.idx||"depot"===this.type?this.file_loading=!0:(this.files_loading[this.idx]=!0,this.$forceUpdate()),this.$store.dispatch(c.b,{object:n,company:a}).then((function(t){if("alone"!==i.idx&&i.files){var e=i.files;e[i.idx]?e[i.idx]=t:e.push(t),"depot"===i.type?i.file_loading=!1:i.files_loading[i.idx]=!1,i.native&&(i.file=e[0]),i.bus.$emit(i.busName,e),i.$forceUpdate()}else{var n=t;i.file_loading=!1,i.bus.$emit(i.busName,n)}})).catch((function(t){"alone"===i.idx?i.file_loading=!1:i.files_loading[i.idx]=!1,i.$forceUpdate()}))}},deleteFile:function(t){if("alone"===t)this.bus.$emit(this.busName,{});else{var e=this.files;e.splice(t,1),this.bus.$emit(this.busName,e)}this.$refs.inputFile.value=null,this.$forceUpdate()},iconFile:function(t){var e=t.mime||"";return e.indexOf("pdf")>-1?"PDF":e.indexOf("docx")>-1?"DOC":e.indexOf("audio")>-1?"AUDIO":e.indexOf("video")>-1?"VIDEO":""}}}),d=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.native?t._e():i("div",[i("input",{ref:"inputFile",staticStyle:{display:"none"},attrs:{id:"inputFile",name:"file",type:"file",accept:t.accept},on:{change:function(e){return t.addFile(e.target.name,e.target.files)}}}),t._v(" "),t.file?i("div",{ref:"new_file",staticClass:"ipt-f-container ipt-f-alone",style:t.myBoxDimensions},[t.file.url&&!t.file_loading?i("div",[i("preview-file",{attrs:{file:t.file,to_download:!0,to_delete:!0,onDelete:function(e){return t.deleteFile("alone")},onClick:function(e){return t.searchFile("alone")}}})],1):i("div",{staticClass:"ipt-f-box-empty bd-dashed",on:{click:function(e){return t.searchFile("alone")}}},[i("span",{staticClass:"icon-attach"},[i("ion-icon",{staticStyle:{"font-size":"20px"},attrs:{name:"attach-outline"}}),t._v(" "),t.file_loading?i("loading",{staticClass:"loading-center",attrs:{color:"#56b2ac"}}):t._e()],1)])]):t._e(),t._v(" "),t._l(t.limit,(function(e,n){return t.files&&"depot"!=t.type?i("div",{staticClass:"ipt-f-container",style:t.myBoxDimensions},[t.files[n]&&!1===t.files_loading[n]?i("div",[i("preview-file",{attrs:{file:t.files[n],to_download:!0,to_delete:!0,height:"110px",onDelete:function(e){return t.deleteFile(n)},onClick:function(e){return t.searchFile(n)}}})],1):i("div",{staticClass:"ipt-f-box ipt-f-box-empty bd-dashed ",on:{click:function(e){return t.searchFile(n)}}},[t.files_loading[n]?i("loading",{attrs:{color:"#56b2ac"}}):t._e()],1)]):t._e()})),t._v(" "),t.files&&"depot"===t.type?i("div",{staticClass:"ipt-f-container bd-dashed",style:t.myContenerDimensions},[i("b-row",t._l(t.files,(function(e,n){return e?i("b-col",{attrs:{cols:"6",sm:"3"}},[i("preview-file",{attrs:{file:e,to_download:!0,to_delete:!0,height:"110px",onDelete:function(e){return t.deleteFile(n)}}})],1):t._e()})),1)],1):t._e()],2),t._v(" "),t.files&&"depot"===t.type?i("button",{staticClass:"btn btn-block btn-primary btn-add",attrs:{type:"button"},on:{click:function(e){return t.searchFile(t.files.length)}}},[t.file_loading?t._e():i("i",{staticClass:"icon ion-ios-add"}),t._v(" "),t.file_loading?i("loading",{attrs:{color:"#56b2ac",size:"16px"}}):t._e()],1):t._e(),t._v(" "),t.native?i("div",{staticClass:"margin-t native"},[t.loading?i("loading",{attrs:{color:"#56b2ac",size:"16px"}}):t._e(),t._v(" "),t.file.url?t._e():i("input",{ref:"inputFile",attrs:{name:"file",type:"file",accept:t.accept},on:{change:function(e){return t.addFile(e.target.name,e.target.files)}}}),t._v(" "),t.file.url?i("div",{staticClass:"flex"},[i("a",{attrs:{href:t.file.url}},[t._v("..."+t._s(t.file.url.slice(-40)))]),t._v(" "),i("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:"Supprimer la pièce jointe",expression:"'Supprimer la pièce jointe'"}],staticClass:"icon ion-ios-attach striked",on:{click:function(e){return t.deleteFile("alone")}}})]):t._e()],1):t._e()])};d._withStripped=!0;var p=i("JFUb");var u=function(t){i("8D53")},f=Object(p.a)(l,d,[],!1,u,"data-v-7da95bc8",null);f.options.__file="src/features/common/inputFileCustom.vue";e.a=f.exports},vOup:function(t,e,i){"use strict";i.d(e,"f",(function(){return o})),i.d(e,"j",(function(){return a})),i.d(e,"i",(function(){return r})),i.d(e,"h",(function(){return s})),i.d(e,"k",(function(){return c})),i.d(e,"c",(function(){return l})),i.d(e,"d",(function(){return d})),i.d(e,"g",(function(){return p})),i.d(e,"e",(function(){return u})),i.d(e,"b",(function(){return f})),i.d(e,"a",(function(){return m}));var n=i("Yvet"),o=function(t,e){return t&&t.length?t.reduce((function(t,i){return t+parseFloat(i[e]||0)}),0):0},a=function(t){return o(t,"total_ht_no_discount")},r=function(t){return o(t,"total_ht")},s=function(t){return o(t,"total_discount")},c=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=p(parseFloat(e),parseFloat(i)),r=o(t,"price_ttc")*(1-n/100);return r+a},l=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"€",n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=parseFloat(e);if("%"===i){var a=void 0;return n&&(a=parseFloat(100-o)/100),n?Math.abs(t-t/a):t*o/100}return 100*o},d=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"€",a=100*parseFloat(t),r=l(a,parseFloat(n),o,!0),s=void 0;s=r&&!isNaN(r)&&n>0?(a+r)/i:a/i;var c=1+parseFloat(e)/100;return Math.round(s/c)/100},p=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"€",a=100*parseFloat(t),r=l(a,parseFloat(n),o),s=void 0;s=r&&!isNaN(r)&&n>0?(a-r)*i:a*i;var c=1+parseFloat(e)/100;return Math.round(s*c)/100},u=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"€",o=100*parseFloat(t),a=l(o,parseFloat(i),n),r=(o-a)*e;return Math.round(r)/100},f=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fr-FR",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"EUR";return Object(n.d)(Math.round(100*t)/100,e,i)},m=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return(Math.round(100*t)/100/1+"").replace(".",",")}}}]);